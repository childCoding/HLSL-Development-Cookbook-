# 简介

## 本章概括
* 半球形环境光
* 方向光
* 点光
* 斑点光
* **胶囊光**
* 投影纹理-点光
* 投影纹理-斑点光
* **多光源情况**

## 介绍

前向光照是一个非常一般的方法在计算不同光源和场景中其他元素相互作用时，例如网格和特效。前向光照方法已经存在从固定管线时期（当时可编程着色器还是一个梦想）直到实现可编程着色器的今天。

一个高级的观点，这个方法工作通过每绘制一个网格需要枚举一次场景中光源。每一个draw call光源通过添加颜色值来点亮最终显示在屏幕上的图片。性能方面，他是非常昂贵的-一个场景有N个光源和M个网格，我们将需要调用N×M次draw call。提高性能有不同的方法，下面的列包含了四大常用的优化：
* 使用所有完全不透明的网格来预热深度缓冲区。（这个方法不会浪费资源，不会在渲染像素时被离相机更近的像素重写）
* 渲染场景中相机时，跳过不可见的光源和场景元素。
* 做边界测试，计算哪个光源影响到哪个网格。基于这个结果，如果光源或网格不相交，跳过他们的draw call。
* 把影响到同一个网格的多个光源合并到单次draw call里，这个方法减少了draw call的次数和开销，但是需要预先准备网格的光照信息。

场景的深度渲染，上面提到的第一种方法，能非常简单的实现，只要要求shader输出深度值即可。第二和第三中方法的实现在CPU，所以我们就不在本书讨论。第四种方法的解释将在本章的最后。由于每一种方法偶是相互独立的，推荐一起使用以提高综合性能。

由于延迟光照和**平铺光照（烘焙？）** 性能方面的提升，前向光照最近这几年不再受欢迎（将在下一章介绍），但明白其如何工作仍然是非常重要的，有下面几个原因：
* 前向光照能完美的照亮场景里不完全透明的元素。实际上延迟光照方法只能拿到不透明的元素，这意味着前向光照方法仍然被需要包含半透明元素的场景中。
* 前向光照在低质量渲染时执行得更好，例如低分辨率反射图。
* 在原型设计和实时性能不重要的情况下，前向光照能更简单的照亮一个场景。

用于渲染的高级着色器语言覆盖了下面所有的秘诀，这意味着读者们将需要明白怎样去做下面几件事情：
* 编译和加载shaders
* 准备能加载和管理场景的一个系统
* 准备一个支持Direct3D draw call的shader渲染框架

使用这项技术的全部顶点缓冲必须包含位置和法线信息。为了达到平滑的结果，使用平滑的顶点法线（应该避免表面法线）。

注意，这个像素着色器必须为每一个网格提供一个像素值。每个网格的颜色值可能是一个常数或者采样来至一个纹理。

## 半球形环境光
